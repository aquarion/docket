@use 'sass:map';

// Easter Festival Theme Variables
$easter-colors: (
  'primary': #4caf50,
  'secondary': #81c784,
  'accent': #ff69b4,
  'grass-light': rgba(76, 175, 80, 0.6),
  'grass-dark': rgba(56, 142, 60, 0.5),
  'day-bg-start': #fff9e6,
  'day-bg-end': #f0f4c3,
  'night-bg-start': #1b5e20,
  'night-bg-end': #2e7d32
);

$easter-dimensions: (
  'grass-height': 80px,
  'grass-front': 50px,
  'grass-back': 35px,
  'egg-font-size': 0.85em,
  'egg-bounce': -2px
);

$easter-animations: (
  'egg-duration': 0.6s,
  'sway-duration': 3s,
  'sway-delay': 0.5s
);

// Functions
@function easter-color($color) {
  @return map.get($easter-colors, $color);
}

@function easter-size($dimension) {
  @return map.get($easter-dimensions, $dimension);
}

@function easter-timing($timing) {
  @return map.get($easter-animations, $timing);
}

// Mixins
@mixin easter-animation($name, $duration, $easing: ease-in-out, $iteration: infinite) {
  animation: $name $duration $easing $iteration;
}

@mixin grass-layer($height, $delay: 0s, $color: easter-color('grass-light')) {
  content: "";
  position: absolute;
  bottom: 0;
  width: 100%;
  height: $height;
  background-image: grass-pattern($color);
  @include easter-animation(sway, easter-timing('sway-duration'));
  animation-delay: $delay;
}

@function grass-pattern($color, $width: 5px, $spacing: 7px) {
  @return repeating-linear-gradient(
    90deg,
    transparent 0,
    transparent $width,
    $color $width,
    $color $spacing
  );
}

@mixin fixed-overlay($z-index: 5) {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  pointer-events: none;
  z-index: $z-index;
  overflow: hidden;
}

@mixin bounce-keyframes($name, $distance) {
  @keyframes #{$name} {
    0%, 100% {
      transform: translateY(0);
    }
    50% {
      transform: translateY($distance);
    }
  }
}

@mixin gradient-background($start, $end, $direction: 135deg) {
  background: linear-gradient($direction, $start 0%, $end 100%);
}

// Easter Egg Styles
.easter-egg {
  display: inline;
  font-size: easter-size('egg-font-size');
  margin: 0 -0.2em;
  vertical-align: -0.1em;
  @include easter-animation(bounce-egg, easter-timing('egg-duration'));
}

// Generate bounce animation
@include bounce-keyframes('bounce-egg', easter-size('egg-bounce'));

// Animated Grass Decoration
.easter-grass {
  @include fixed-overlay();
  height: easter-size('grass-height');
  background: transparent;

  &::before {
    @include grass-layer(
      easter-size('grass-front'),
      0s,
      easter-color('grass-light')
    );
  }

  &::after {
    @include grass-layer(
      easter-size('grass-back'),
      easter-timing('sway-delay'),
      easter-color('grass-dark')
    );
    // Custom pattern for back layer
    background-image: grass-pattern(
      easter-color('grass-dark'),
      8px,
      10px
    );
  }
}

// Sway animation
@keyframes sway {
  0%, 100% {
    transform: translateX(0);
  }
  50% {
    transform: translateX(2px);
  }
}

// Easter Theme Context
body.easter {
  // CSS Custom Properties for theme colors
  --easter-primary: #{easter-color('primary')};
  --easter-secondary: #{easter-color('secondary')};
  --easter-accent: #{easter-color('accent')};

  // Day/Night specific backgrounds
  &.daytime {
    @include gradient-background(
      easter-color('day-bg-start'),
      easter-color('day-bg-end')
    );
  }

  &.nighttime {
    @include gradient-background(
      easter-color('night-bg-start'),
      easter-color('night-bg-end')
    );
  }
}
